
### 프로그램상에서 도메인 이름을 쓸 필요가 있는가? <br>

* **IP주소**는 **도메인 이름**에 비해 상대적으로 변경의 확률이 **높다.**
 
  - 프로그램 사용자에게는 매우 편리한 실행방법을 제공해야함.
  
  - 특히 ISP 서비스를 제공하는 통신사업자의 도움으로 IP를 유지하고 있다면 시스템과 관련된 여러 가지 이유로 IP주소의 변경은 언제든지 발생할 수 있음.
  
    + 때문에 **`IP주소를 바탕으로 프로그램을 작성하는 것은 좋은 방법이 아님.`**

* 도메인 이름을 일단 등록하고나면 평생 유지가 가능하니, 이를 이용해서 코드를 작성하는 편이 나을 수 있음.

  - 이렇게 되면 프로그램이 실행될 때마다 도메인 이름을 근거로 IP주소를 얻어온 다음 서버에 접속하니, 서버의 IP주소로부터 클라이언트 프로그램은 자유로울 수 있음.

* 위와 같은 이유로 **IP주소와 도메인 이름 사이의 변환함수가 필요함.**

<br>

### 도메인 이름을 이용해서 IP주소 얻어오기 <br>

* 아래의 함수를 이용하면 **문자열 형태의 도메인 이름으로부터 IP의 주소정보를 얻을 수 있음.**

```C
#include <netdb.h>

/* @return : 성공 시 hostent 구조체 변수의 주소 값, 실패 시 NULL 포인터 반환
 * @param  :  hostname : 구조체 변수 hostent을 전달.
 */
struct hostent * gethostbyname(const char * hostname);
```

* 변환하고자 하는 도메인의 이름을 문자열 형태로 전달하면 해당 도메인의 IP 주소정보가 **`hostent`** 라는 구조체의 변수에 담겨서 반환됨.

<br>

* 이 구조체는 다음과 같이 정의되어 있음.

  + IP정보만 반환되는 것이 아니라, 여러 가지 다른 정보들도 덤으로 반환됨.

  + 도메인 이름을 IP로 변환하는 경우에는 **`h_addr_list`** 만 신경쓰면 됨.

```C
struct hostent
{
    char * h_name;      // official name
    char ** h_aliases;  // alias list
    int h_addrtype;     // host address type
    int h_length;       // address length
    char ** h_addr_list // address list  
}
```
간단한 각각의 멤버 설명은 다음과 같음. 

<br>

* **`h_name`**

  + 이 멤버에는 **공식 도메인 이름(Official domain name)** 이라는 것이 저장됨.

<hr>

* **`h_aliases`**

  + 같은 메인 페이지인데도 다른 도메인 이름으로 접속할 수 있는 경우가 있음. 
  
  + 하나의 IP에 둘 이상의 도메인 이름을 지정하는 것이 가능하기 때문에, 공식 도메인 이름 이외에 해당 메인 페이지에 접속할 수 있는 **다른 도메인 이름의 지정이 가능함.**

  + 이들 정보는 **`h_aliases`** 를 통해서 얻을 수 있음.

<hr>

* **`h_addrtype`**

  + `gethostbyname`함수는 IPv4뿐만 아니라 IPv6까지 지원함. 때문에 **`h_addr_list`** 로 반환된 IP주소의 **주소체계**에 대한 정보를 이 멤버를 통해 반환함.

  + IPv4의 경우 이 멤버에는 `AF_INET`이 저장됨.

<hr>

* **`h_length`**

  + 함수호출의 결과로 반환된 IP주소의 크기정보가 담김.

  + IPv4의 경우에는 4바이트이므로 4가 저장되고, IPv6의 경우에는 16바이트이므로 16이 저장됨.

<hr>

* **`h_addr_list`**

  + **가장 중요한 멤버**

  + 이 멤버를 통해서 **도메인 이름에 대한 IP주소가 정수의 형태로 반환됨.**

  + 접속자수가 많은 서버는 하나의 도메인 이름에 대응하는 IP를 여러 개 둬서, 둘 이상의 서버로 부하를 분산시킬 수 있음. 
  
    - 이러한 경우에도 이 멤버를 통해 모든 IP의 주소정보를 얻을 수 있음.


<br>
<br>

* 마지막으로 `gethostbyname`함수호출 후에 반환되는 **`hostent`** 구조체 변수의 구성을 그림을 통해서 정리함.

<br>

<p align="center">
 <img src="https://user-images.githubusercontent.com/70312248/169587373-a4e359de-8960-408f-9ee1-db5fa8743312.png" width="668" height="449"/>  
</p>

<br>
